---
title: "prepare_simu_data"
author: "Xiaona"
date: "2024-07-05"
output: html_document
---
```{r message=FALSE, warning=FALSE}
library(tidyr)
library(dplyr)
library(quantreg)
library(parallel)
library(survival)
library(ggplot2)

source("../code/functions_all_new.R")

full.long <- read.csv("../data/long_reg_n400_BinCov.csv")
full.short <- read.csv("../data/short_reg_n400_BinCov.csv")


short.List <- simu_list(full.short, 2000) #split each simulation into a list
long.List <- simu_list(full.long, 2000) #split each simulation into a list

short.data <- short.List[[1]]
short.data$id <- 1:nrow(short.data) 
short.data.out <- short.data %>%
  select(id, everything(), - group)

long.data.out <- left_join(long.List[[1]],short.data.out[, c("id", "obs_id")], by = "obs_id" ) %>%
  select(id, everything(), -group, -obs_id) %>%
  rename(obs_id = id)

short.data.out2 <- short.data.out %>%
  select(-obs_id) %>%
  rename(obs_id = id)

write.csv(long.data.out, "reg_data_sim_long.csv", row.names = F)
write.csv(short.data.out2, "reg_data_sim_short.csv", row.names = F)
```

